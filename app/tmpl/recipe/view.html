<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:py="http://genshi.edgewall.org/"
      xmlns:xi="http://www.w3.org/2001/XInclude">
<head>
  <title>Recipe "${recipe.name}" | Brew Journal</title>
  <xi:include href="../_incl/head.html"/>
  <style type="text/css">
TABLE BUTTON
{
  visibility: hidden;
}

TABLE:hover BUTTON
{
  visibility: inherit;
}
  </style>
  <script type="application/javascript">
$(document).ready(function() {
$('tr.deletable input[type=submit]').click(function()
  {
    // find containing form
    // find child 'delete_id' field
    // set delete_id to ... id from where?
  });
});

// get jquery-ui?
/*
$(document).ready(function(){
$('input[name=insert_date]').datepicker();
});
*/
  </script>
</head>
<body>
<xi:include href="../_incl/body-top-bar.html"/>

<h1>recipe : ${recipe.name}</h1>

<h2>overview</h2>

<div id="overview">
  <div>
    <table width="40%">
      <tr><th>name</th><td>${recipe.name}</td></tr>
      <tr><th>style</th><td>${recipe.style.name} (${recipe.style.bjcp_code})</td></tr>
      <tr><th>batch_size</th><td>${recipe.batch_size} ${recipe.batch_size_units}</td></tr>
      <tr><th>type</th><td>${recipe.type}</td></tr>
    </table>
    <div><a href="#" onClick="$('#overview').children().slideToggle()">(edit)</a></div>
  </div>
  <div style="display: none">
    <form method="post">
      <table width="40%" class="form" py:content="std.Markup(recipe_form.as_table())"/>
      <input type="submit" name="submit" value="update"/>
    </form>
    <div><a href="#" onClick="$('#overview').children().slideToggle()">(cancel edit)</a></div>
  </div>
</div>


<h2>grains</h2>
<form method="post" action="./grain/" id="grain_form">
  <input type="hidden" name="delete_id" value="-1"/>
<table width="70%">
  <tr>
    <th>grain</th>
    <th>amount</th>
    <th>&mdash;</th>
  </tr>
  <tr py:for="grain in grains">
    <td>${grain.grain.name}</td>
    <td>${grain.amount_value} ${grain.amount_units}</td>
    <td><button onClick="$('#grain_form').find('[name=delete_id]').val(${grain.id}); $('#grain_form').get()[0].submit(); return false;">del</button></td>
  </tr>
  <tr class="add">
    <td colspan="3"><em><button value="add" onClick="$('#grain_form .add').toggle(); return false;">add</button></em></td>
  </tr>
  <tr class="add" style="display:none">
    <td>${std.Markup(grain_form['grain'])}</td>
    <td>${std.Markup(grain_form['amount_value'])} ${std.Markup(grain_form['amount_units'])}</td>
    <td><input type="submit" name="submit" value="add"/></td>
  </tr>
</table>
</form>

<h2>hops</h2>

<form method="post" action="./hop/" id="hop_form">
<table width="70%">
  <tr>
    <th>hop</th>
    <th>amount</th>
    <th>boil time</th>
    <th>&mdash;</th>
  </tr>
  <tr py:for="hop in hops" class="deletable">
    <td>${hop.hop.name}</td>
    <td>${hop.amount_value} ${hop.amount_units}</td>
    <td>${hop.boil_time} minutes</td>
    <td><input type="submit" name="submit" value="del"/></td>
  </tr>
  <tr class="add">
    <td colspan="4"><em><button value="add" onClick="$('#hop_form .add').toggle(); return false;">add</button></em></td>
  </tr>
  <tr class="add" style="display:none">
    <td>${std.Markup(hop_form['hop'])}</td>
    <td>${std.Markup(hop_form['amount_value'])} ${std.Markup(hop_form['amount_units'])}</td>
    <td>${std.Markup(hop_form['boil_time'])} minutes</td>
    <td><input type="submit" name="submit" value="add"/></td>
  </tr>
</table>
</form>

<h2>adjuncts</h2>

<form method="post" action="./adjunct" id="adj_form">
<table width="70%">
  <tr>
    <th>adjunct</th>
    <th>amount</th>
    <th>boil time</th>
    <th>notes</th>
    <th>&mdash;</th>
  </tr>
  <tr py:for="adjunct in adjuncts" class="deletable">
    <td>${adjunct.adjunct.name}</td>
    <td>${adjunct.amount_value} ${adjunct.amount_units}</td>
    <td>${adjunct.boil_time} minutes</td>
    <td>${adjunct.notes}</td>
    <td><input type="submit" name="submit" value="del"/></td>
  </tr>
  <tr class="add">
    <td colspan="5"><em><button value="add" onClick="$('#adj_form .add').toggle(); return false;">add</button></em></td>
  </tr>
  <tr class="add" style="display:none">
    <td>${std.Markup(adj_form['adjunct'])}</td>
    <td>${std.Markup(adj_form['amount_value'])} ${std.Markup(adj_form['amount_units'])}</td>
    <td>${std.Markup(adj_form['boil_time'])} minutes</td>
    <td>${std.Markup(adj_form['notes'])}</td>
    <td><input type="submit" name="submit" value="add" /></td>
  </tr>
</table>
</form>

<h2>yeast</h2>
<form method="post" value="./yeast/" id="yeast_form">
<table width="70%">
  <tr>
    <th>yeast</th>
    <th>is ideal</th>
    <th>&mdash;</th>
  </tr>
  <tr py:for="yeast in yeasts" class="deletable">
    <td>${yeast.yeast.manufacturer} ${yeast.yeast.ident}</td>
    <td>${yeast.ideal}</td>
    <td><input type="submit" name="submit" value="del"/></td>
  </tr>
  <tr class="add">
    <td colspan="5"><em><button value="add" onClick="$('#yeast_form .add').toggle(); return false;">add</button></em></td>
  </tr>
  <tr class="add" style="display:none">
    <td>${std.Markup(yeast_form['yeast'])}</td>
    <td>${std.Markup(yeast_form['is_ideal'])}</td>
    <td><input type="submit" name="submit" value="add"/></td>
  </tr>
</table>
</form>

</body>
</html>
